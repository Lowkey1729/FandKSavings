



## About Fandk E-wallet system


Creating an API for FandK E-Wallet system doing the folowing
- Users can create an account and welcome email would be sent to the cusotmer's email upon registration.
- Users can fund their wallet using thier atm cards.
- Users can fund other users wallet using a unique identiifer that each user has.

## Models
- User
- Wallet
- With a one to one relationship.

## Controllers
- RegisterController
- BaseController
- ApiPaystackController
- WalletApiController

## Users can create an account and welcome email would be sent to the cusotmer's email upon registration.
- I used Postman to test this section of the API.
- Installing Laravel 8 .
- Installing Laravel Passport for Authenticating APIs.
- I Created Migration files for users and wallets.
- Change my api driver in auth.php found in Config folder from "token" to "passport".
- Created an API Folder in Controller Folder to Keep all The API Controllers there.
- The Major Controllers used are (ApiPaystackController,BaseController,RegisterController,WalletApiController)
- BaseController controls the api response for success Response and Error response
- RegisterController for registration and Login of users.
- All of the route is stored in api.php
- All of the routes are protected except the login and register route
- I created theCross-Origin Resource Sharing (CORS) Configuration middleware to allow the the api access to the methods, headers, and origin
- I also created the (json.response) middleware to Accept headers or Content-type like 'application\json'.
- These middlewares make it easily accessible to access tokens and cookies that would be used to authenticate users consuming  the api.
- I created FandKmail.php using the php artisan make:mail command which is used to control the mail to be sent to the registered email address.
- The mail is tested using Mailtrap


## Users funding his/her wallet via Paystack.
- I ran all of these in the ApiPaystackController.
- the methods in this controller are protected using the "auth:api" middleware(any user without a fresh api token will not be able to access the methods here.).
- The first method in the ApiPaystackController initialises the payment via paystack api which in return redirects to Paystack checkout where card details are inputed.
- The reference code generated by paystack api is stored in the database which is then used to verify the payment so as to fetch the amount paid in the successful transaction then stored in the wallet table.
- A callback url runs the callback url for verifying the transactionmade after successful payout.
- For those with no wallet before, I generated a unique 8 digit wallet account number  and details of last transaction is stored in the wallet table.
- For those with already existing wallet account number , thier balance is updated to thier previous balance in addition to the amount funded via paystack.
- The account number is generated in such a way that it runs a loop to check if such account number exists in the wallets table then another 8 unique digit is generated then stored in the table.



### Users funding other users wallet

- I ran all of this function in the WalletApiController
- the methods in this controller are protected using the "auth:api" middleware(any user without a fresh api token will not be able to access the methods here.).
- To credit X wallet, Y has to enter X's 8 digit unique account number and the amount to be paid.
- I fetched details of X using is account number.
- Using the api tokens, Y's account number is also fetched from wallets table to check if Y has sufficient amount to transact with X.
- It is also used to stop Y from transacting with his/her account.
- X's account number entered by Y is checked if it exists in the wallets table.
- The amount sent by Y is subtracted from Y's balance then added to X's balance.
- The column "details_of_last_transaction" in wallets table is then updated to who funded thier account. e.g "Olarewaju Mojeed funded your wallet".  




The Laravel framework is open-sourced software licensed under the [MIT license](https://opensource.org/licenses/MIT).
